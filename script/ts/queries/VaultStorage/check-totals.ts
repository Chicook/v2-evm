import { ethers } from "ethers";
import chains from "../../entities/chains";
import { loadConfig } from "../../utils/config";
import collaterals from "../../entities/collaterals";
import { VaultStorage__factory } from "../../../../typechain";
import { getSubAccount } from "../../utils/account";
import _ from "lodash";
import { Command } from "commander";
import { MulticallWrapper } from "../../wrappers/MulticallWrapper";
import { IMultiContractCall } from "../../wrappers/MulticallWrapper/interface";

type CheckTotalTable = {
  collateralSymbol: string;
  traderCollateral: string;
  hlpLiquidity: string;
  protocolFees: string;
  devFees: string;
  fundingFeeReserve: string;
  sum: string;
  totalAmount: string;
  diff: string;
};

async function main(chainId: number, blockNumber?: number) {
  const accounts = [
    "0x164b5ffefd173c70d0faedb2cd188d8dfdec3ded",
    "0x008d7a063eb5f7c706b72fbe48ce532defe153d1",
    "0xf78f4010c0d493874e938ab4df23dcdb5f042fef",
    "0xcedad411534fcc2692b17c3259272f3321d3ed68",
    "0x38a56adc67b2701f31ea8de4e61e1c4cb5467bbc",
    "0xc40af2937ed35c6360c452335648e1b36329ad9d",
    "0xbd76c6487dabef207470afdb6f332c0432482f45",
    "0xf4a6d68b771998f6333b325ac021c9b18a664530",
    "0x2820a2b534ec948412699074389edf8aab88ad30",
    "0xa025494aebfcc2be19e8cba3ae8d612796fa172c",
    "0x4b5abc1e18f9cecae169a63bd0a40bae1c44f515",
    "0x1d078afc08f148f0119ebacffdadb5e0715d0ae8",
    "0xabd263d64781a01fe3d9b17f12fc95f6fccb2943",
    "0x37633c9f778c44e852914c7056cbbbf75323dfd6",
    "0xbfdf29c07daf013d6b28de0d0a69375b70277db6",
    "0xc8728ae130381eb77fc9a8b715564b00e83e19df",
    "0x7a01e7a91b34ca5b27bc18c68aa9484a7a683295",
    "0xd04df50ed440a44242b9ca8d874606f7b900a534",
    "0xf28570694a6c9cd0494955966ae75af61abf5a07",
    "0x39e19324375ebde1fec687c7164dccec140a4eac",
    "0xf9bc29a9ce38f20b8e3403a1973152c37b5fd711",
    "0xc96caaac2cd4df2bfaab55f401e1ef5888b02ebb",
    "0xeaf55eaffdea591d89fc1f1fb7e910962c8a2e59",
    "0xd0ab12d014de6505334a2447a9df12d8dc207b83",
    "0x8ab7091dacd6e4ff3c6f80ff1db02616f553c432",
    "0xf65831dbe1331212128ffffa963045bc4857c42c",
    "0x39af8e69233e891cb2c5d7f257a50b743f0db085",
    "0x10e3db0e0075205958542eaef6ebf30cff560869",
    "0x7110d3e465845fa8bafaf6fc07afc6cb4a981d68",
    "0x6ef7a347feb742be14bb206b644de487fb4b1433",
    "0x8d7e609eabc813df14ef5ae36346de96503af0c4",
    "0x18f2c896043706f97b1dab7703ec2118693385de",
    "0x50e943bca9fbb5f00a444df651368c436c4ab5ac",
    "0xc8edd2663bb4284d0bff2983b3b690e709f869d5",
    "0x918548782763ec5704acc2c8c94624929efe28be",
    "0x8fa496b4e630911993dcad21c0168f83b7931352",
    "0x156ac784bae328f6afb6403460145ba8b029d3b5",
    "0xba6a75026476d937cd2812432e13fff80f636042",
    "0xebaa3afed842abde36142ed7fb7e41e0b990a345",
    "0x8ec90366d8751818c55c90cd8bae402d9176495b",
    "0x9f83103560369592dddface141343d538ed45332",
    "0x4878edc1c560fa7acd044529aef025c70fc3f0ce",
    "0x95b05f935655c37ada2088c5767e5006f230b068",
    "0x29b897bd20822e52ae32d900a685c448799c00a9",
    "0xebfdc68363057beebfc331b0da871e696d2d0b62",
    "0x5e2ab92dae015b6d9b8c0bea30184d84ea1c633b",
    "0x4ca1ff660f4b5bb15b4ef599c2cfa9728e10723a",
    "0xfa60c33563eeac650b16659f85d033818e96af4f",
    "0x5bb967a3b3e2eb96487d23f3bf281c38f91abc8a",
    "0x607ab28cd8d2b4f016382f5ccc4ef423ea2ede7a",
    "0xf08545ba1c5e9f25f3e3ef12e8997cbb1eae9e54",
    "0x6629ec35c8aa279ba45dbfb575c728d3812ae31a",
    "0xb6b99ba371ea673f946c949bbfaaf002ef165306",
    "0x61afb78ac7d1dfd5e0606ad675795d4e2dcb9dc8",
    "0x8a9db8051df5ca5a3d9b156073f25fade6184c1f",
    "0xc8cc96d0d7087bf6bcb7f35d80c7634a00030799",
    "0x8e0d3080a88a1059287c4c669ed73de5a3cc19f6",
    "0x831e4ecf60dd9727d30c3610fa15ad52fa1ff54f",
    "0xbce338b553195f9ef224f7854e89d4aa75c8b83a",
    "0xcba80e2cd4a5c1a852ce1f14c85a0df6d007a268",
    "0x3c8319dd83fa18ec1a0df2acf65277a731514d67",
    "0x2c4e585d1e2c068a21cd8bb5e88939f52b2bdb0a",
    "0x189ba1d201d857e38e7aadc290b0bf6d9085607e",
    "0x59d2e0a2be0db463c36038a5fd2535f58ab3b38f",
    "0x02a73cd5c9135b68798838407a136b41ddea3c5e",
    "0x47430de9669b7d303fe3c5aafb3a7357753d1c22",
    "0x402f83aa64ac1e869a7d7b233b870a79d6c44257",
    "0xa36b9297afb449e8aa4bd4060ce98ffaa65896fa",
    "0x212c2a2891227f39b48d655c5eca0b1377daff90",
    "0x1cf044dd8a89babba6166566a2bcd4fa0e693da0",
    "0x9017c92270f465fe35c8adf47ad9b2c344765561",
    "0x2ff06ed0c3a9379a32c81e92cba7a0553630022d",
    "0x20528a4c85aa4c85e72089a4fb7e3bbb7711ff15",
    "0x8ed83f439cdfae61005fdcc7388dd0052aa3b0dd",
    "0x27aaf8b0c22f76b486cdc81bc07f345147aafda2",
    "0xc56eaa77b5eea884d73ba874a207951aa8abf1b4",
    "0x4024e55bcf7f4535df4575526a69fe74f5f7c246",
    "0x86cb2f7b3ba84b53307670e4dbe8040c7f34170d",
    "0x469adaf766fb35f1a3c2569fe8c57a50f4b39131",
    "0xd742e1d6455ca947794dbd32f17ac4e95765af60",
    "0xf9ad2a825f33ce796c1dead911ccc1d7bb2e8e3e",
    "0x657018edddff213fbcdb367052f8810aab53eb82",
    "0xaeaeeeec093c2a1084822c26b1eb3630f0f3d8b9",
    "0x815612815d7fb01b1e8a97fe4a0996e77245a3aa",
    "0x09711a9e501e03769f32a0f8fc09aa517337b388",
    "0x1f7da94f8ffb08ef04809e588a060224c4137877",
    "0xb36c1fb9a64e9e20759c799598668ec48cd4899f",
    "0x3f7b01e9ff20ec624d91cec2f44e77ecdf2effb7",
    "0xdce94ddc7703fc0bb1e210012fbb66f968812aab",
    "0x95aaef5544c20de05598cdde21f661b47a636718",
    "0x5e153794655ae20c3305ba5b53f8db8d7fbd5f41",
    "0xa9df5f70e85ce1271aee4e087b3b5088c3658862",
    "0x79e80e8f41cab7738af9c98194bc68e68152f6d5",
    "0x480a54a3aa47f9351d9c0518b394c032f20a4713",
    "0xc78a68b6ed2de7e98a7c8fc8f253d570b8941cc2",
    "0x10ea740f5526d7e262beae81a4ec8d944824ef1a",
    "0x9edb4aeba2753499d88dc40086a5230182889b52",
    "0xdd9db3cd6fdbde203fb46cbdfde05e2368b05670",
    "0x78c2af9ada71b08f75df33cbc95d1bcd248c6948",
    "0x63122290895127671a36fddac94087dd44e3a99c",
    "0xc44a3a88e786a37d27445c847b3d6f439321a4cb",
    "0x370891688c055df7398f7aabeee0f78037d45a3b",
    "0x34bdc44a9141348d3b32f2b551a9133215d51c78",
    "0x8bcf6cf33b996019a7565932e42f4f9530a1624a",
    "0xbec80aa0819389e34405b276afdf2077eccfe4be",
    "0xbb73b0fd70b9c57b14adbb3ed9fbf726b947236c",
    "0xad32b0037bbab24b977f14629a1c6ff3f81ef131",
    "0xd249e9c040ab88a0028482419a6933db2850500c",
    "0xcd719caa1f2656b9bbc2d044b86f5d36f3cac97d",
    "0xf1d271bc259349f9b47eedf7066decd72424bd19",
    "0xd4e3473b279661767ffdf3ac4113e2979dd5d075",
    "0x29493ba35989c1412480e3c9e47c363bd2f6cb9c",
    "0xd6543336fbab71511cf8b8c4e71f78ca945aa42c",
    "0xb8bc90316bd87216d3f75dca201bc00e1481c31f",
    "0x539d9a0783e563775430988e79f71d0b5dcba5bb",
    "0xf025a636bcc7a3ed3c2d6ba72f45b63e8df6ad8d",
    "0x1e896cd996e83433239ce762d1cb126d2409736c",
    "0x2fd10a12d9bac5413420f9f5c64d7565817e897c",
    "0x6463dbd8ae7dfb08cfe903cdf98ea7558faf36e6",
    "0x4356eb6b110ea16a8d2398bfc7056ee7ef8b79d3",
    "0xc896aee89694c8bdfb72c39022d7f7b70f046828",
    "0xf9a03f00e0779d14ebdafa684cfccc4ba077692b",
    "0xfda82c6ee24a71d3e44edd4ba71931219bd151e6",
    "0xeb0647351de730cc7971de3e0a7d03ac8004d0eb",
    "0x9940048d0a2e62ccf34157161121e9c0ef2faa37",
    "0x2d7a3046fdaff9a9bc1c5211b4ca757ce5559841",
    "0x366d536ab09d17acd867aadc698fc6cc9b3b5622",
    "0x1fd21faebbaad314128c2e7c0e56be92aa47b12d",
    "0x63441f0000ee4e604d51f46565c25fba9226d87a",
    "0xb3f5f8339f829ed60c25aea5573cdd0923c71064",
    "0x18ed0c7ef91adb5ccb744661e33440b21f76d711",
    "0xa73e6920ee88460e00033c7419f1237eee866cae",
    "0x159b7289c761a0346f4048261593709437c811dc",
    "0x64d1d3ffd64d1d8de623adbf88171f5483760350",
    "0xd23dc3aeabbfddb5e8866f77f5336a627173584f",
    "0xdda7a01df6c29df1a81587a772aff6e4d69cd07b",
    "0x6cabf068cf43beccfbea0ee0d939988c83fe596b",
    "0x82699d325f6eb5d7c1be140898481d520d6f06f4",
    "0xe77fb6d4a9d94d919fd290f2ef1a21b618ba9eb2",
    "0x976b35a7303b7bbc8a0c5f9ae88e585152cbbeac",
    "0x2b96d2a3bc8237aeaf392f1af39e70b230f4ee48",
    "0x2001b8a69b88ce0ea1bd1546f4b51da763f78a6c",
    "0x1f8a579a3e16cfe04197b6fdbd3be2af82631645",
    "0x90304795fab3ec9f6c453b659489960578259d61",
    "0x69383d63813ef83d0abd9b42ef168bd04853a0b2",
    "0x6b20099a607a825a4eb5aeb3b5766434bc73552e",
    "0x6ccc371476886b75a4787b3c01c619eed46a83a0",
    "0x312959e24862bdea6e2e93a73e0a5deeb9578f6a",
    "0x4a2f6eb09bc17ce8a8e0481b28c2b32714eca06c",
    "0x089bedea33e3d29a58c5e2f4fd4951388572d68f",
    "0xccbd326a9ec75476f5ab396880bf9e890d8bdc6c",
    "0xede341454cc872489ed10bfac0b8833cb3c8d404",
    "0xa4c651475f98bdd8f10b27782bdc803e2e11d04c",
    "0x6065a474addafe16972e9aad0bd2104ebcfd2dd4",
    "0x69d925eeaeee4c74408ee8c55c0605d0f1e0acd0",
    "0xe529624a0005aa8433f4e0b6d35169c29c806b42",
    "0x817cca48a045f1c72fea7de1804ca46075f7116d",
    "0x14025ebc34bcf04eb0481c2b18a98f389644e84e",
    "0x1607c5462b29e94db59e544ef35705faba6e7ef3",
    "0xabb4aebcf1fc850266dcd46a01968d2230a00289",
    "0x5ae316a862f3e75c2827cc611e58a20ebee05293",
    "0xf222a54f048f1cc3821f8c5adaa50f80dee06ad5",
    "0xefa292eb6a1ec820c3262ab141ec3d80a4d916bd",
    "0x19c2396c0f6b45b05c94245525933cbe8ddcb27c",
    "0xfa2df969bfb2b9eeb06584f034c4214419f71ecf",
    "0xf203035967cf18b9cbab9e6bc8b7c1d001368fa3",
    "0x24353b46bac8f8cdb88642ded6866359c9b575e9",
    "0xdd0206010ca82ff22303b58863b3a6f3006c86c4",
    "0xb6683ad5656241b200421a0aca57c6e5c1a2b3ff",
    "0x1d8a02843ee285501954fd1fcdb486d70c368eba",
    "0x07eac6dc2af876d2f0402f6804cc6ceaa0cd20cd",
    "0x469656e1b6a66022b2f66eb1dd4214818d5a678a",
    "0x5b2d776723f14c881bc69b5a479fa7ea0e6e3dc1",
    "0x0135111a7f054ffcbbf429ccdb983724a87b4009",
    "0x87e696610f11480ed9d01b1e2e26a90eb5832a02",
    "0x4aa8d4d19c7ca3cd4cdbd655b11072a5e36c0782",
    "0x2469a4d280b5622e6ee4dfdbf7ea5f0d8804bda9",
    "0x0dfd01280065c661f913165cfff53160e9bfd8c8",
    "0x283c1b6305099a3157cf31b5f1f87d7e2ede8b60",
    "0x2abcf37e4a3efb5024a767123b44b2faab716460",
    "0x6ebcd1bffb2d6be2efc3c33f09250a95745b7bb1",
    "0x0047cc76a3980eab7dd6e7eb0d50132c2625c997",
    "0x04bee613690e98a1959f236c38abaa5f2439b14a",
    "0xe02c56d4b237d704a105930a0f3b4654456a3261",
    "0x50d84a38eed106d692840a20a20aba6df6890d52",
    "0x10c69d9d8ae54fd1ab12a4bec82c2695b977bcec",
    "0xa7d73f12e492409939e346031336ce1bdfd49674",
    "0xc45e95825c8d7696153f4675680fffbc17352430",
    "0xac063b103b9504523569c0a7f4a43db280d6e5bc",
    "0xe1ab77fa0c089dd578fa1e542e50d655a37c3b05",
    "0xbfb4ce2599163a604c9b1185efd18f90a06e9b8b",
    "0x1d8225eccb9bc3db6cfb47deb3125b504b46552e",
    "0x1de8933644884bdde909e71efd367b2fdc4fbd87",
    "0x03000a0ecb1898040c26cd418570cd480775f0da",
    "0x9dcae8f5bcea6350055fbb17808bb610f43ff9ab",
    "0x7e308573643db0139faea81d7fcd8edb2723b7fd",
    "0xad46b188177ea92d53a1f179e30910eed3129bbc",
    "0xe0fb9b3a67cd620270aaadc759dc8922037a9174",
    "0x5ff87229d2dd04b8231ac75947a9c36195590cfb",
    "0x306b5629d35bc5d2fbd3ab8c975b911dc1783a21",
    "0x8e7cd13bd07ee0d818c3da880aa5305d94874015",
    "0x3b63020e0aa6bcb9dbfaa321837da419ea5b0ff2",
    "0x0fb00b9d74684444f2ff41cb17544ee9f98c83b8",
    "0x69aea131aa2c758e65affb07adac06a9d42d42ff",
    "0x2aaac6bd9f312936e1fb414d3856bc37d0b037b5",
    "0xd46480b5881f8b9bee973f6299e88ab29c73b6d4",
    "0x24e32bb964721dfac9dee9e9ff71ac476652e8ef",
    "0x6ab288bb38d9eed8feaa69ad8642c435cf8afffc",
    "0xbe398bb77318b58612ef5cb920dbbc2350bf3230",
    "0x13b4ffd03e9093465c9dfed09227b6232a823a9b",
    "0xcfb0649283cdc540dac31a3db0c7f3126a5c6751",
    "0x8c5ee5afe1e3ce261e312fc0edc2a4b6f0f49338",
    "0x9ac6e89c336a1608f9e490a45e2f12711a54930f",
    "0x449ee7be68ed9e0b1083df95140e5b3d859817f2",
    "0x023b368296f1a9cdc5f9a502ed85720e2e468784",
    "0xa17083d574c8d7d46ac4cf740b36925fea768a7a",
    "0xed23c9aec9a40e3722bc2b72db9c2fb4c8be92ed",
    "0x54180973ec6fc6e7a8e58827532a4908ceb6a30c",
    "0x850d8744632e2769981541c841247b0b40df555c",
    "0x93ff7898c4b1d782755bcc7a4945a7344b81b056",
    "0x8fb25fcdb7884231edcc2165df151b27fc529089",
    "0x24db8a0a16da2812b55af4d0f3a8ada8a68a330f",
    "0x9b7d7c4ce98036c4d6f3d638a00e220e083116c7",
    "0xe02a2fb784c07e3af93615eb047a738c72bd8696",
    "0x6ab972159245fc0c43c567470edcb67e31e79284",
    "0x88c9a3d9dbd31384cf7cd7f2766db05928347689",
    "0x2c8b08d63002ee19cab5db8a4c2de5fedc5bf604",
    "0xf419c6275d9c024632b3db13dcc9f91e18bfc104",
    "0xad4edf48a844f9ba5cd7af0c86dd8f3a09a588a6",
    "0x28207ef733b5eb0c06c059fe8490e5c752f36d1a",
    "0x41474e6ed6f2bc2256809ecaa1a22a95c77a15e2",
    "0xfd27c9fc2bb221dfb7de8de1858b336ff682c9e6",
    "0x31e015e65b5fb16b8f3f415a435da19af5b3efd4",
    "0x48b34631e39fca715e64fbe5ccd32788e8292e00",
    "0xef8a3991bc37517f6426b996df42e25fa4eeeecb",
    "0x24a498cda4a8f56125e6d167004598b5d2b19dc4",
    "0x78cb1a319c0cb0186cccc56ebd344645df1070f6",
    "0x528836082e417d7b839e17a17964694266aa29a5",
    "0x275cac7ec3c4555845131a4e3f55ec42122a7d75",
    "0xb7e163c290f1301adc7d37b42ed6d7067093516a",
    "0xf52f89b93b8a10e864786d7ea3697b8fda913861",
    "0x6fe6a50f1017d485a2750f1a69273d82b50f54c6",
    "0x70598a69c0bcb3890383650a2fe02274b6cccda3",
    "0x286ba134282b0bddb3bacea9452704ee70a1bcf4",
    "0xcc9bd2bdff4a835c11861c9b6b1061ac51f661b5",
    "0x34ca13442bfc2a5fa5969ff2e6bef76150bead2e",
    "0xac7a677815ecd9c0ad2b13686f7ab54ff7485762",
    "0x0566d52171036546de97d797da1ee35088ea182e",
    "0xddd53521c1685549708103d122b2540ffb8b4428",
    "0xc348fa0aa51577f17f0ba59aef214f66cda35213",
    "0x5b655943a8754173074c8f009b1719e9f742973a",
    "0xb11ab19ad4ceab01c2b3a085349c824b52132828",
    "0x5d7b96908357a7ebc2c5143daf7faf0b6d5236bf",
    "0xc022e7ab9bed4874b7879d5beaa6de5e12160fae",
    "0xeddf5f3e1966e4fc67af8ee537a43f3f3304765b",
    "0x28ca78be125f95517d1d933c463afade65bdaa52",
    "0x741b5647d826d65759c7dde40ef0c7371041e807",
    "0x6e11aebc1dfa9bc375360c45eb0b604f27852a2e",
    "0x4f10c94f3e8de54136a39fa5f027e354f8cd39cc",
    "0xe005d10db399ebc0a4c025de811a5fec0a98464e",
    "0x694d064fc85b1fd8b74f8b2e9c3fab072cf7b52c",
    "0xd8844b1661e8d7f22eb34feaee49b888be3f7f9b",
    "0x01328e82fbc87d90fcfe7ee3a7932a6da3148f5b",
    "0x7077ee5f7d40970a1ad2b6a604cf0039b0748133",
    "0x5d47e5d242a8f66a6286b0a2353868875f5d6068",
    "0xca077a26544657b08508e1f02236fc10bac86bf3",
    "0x0578c797798ae89b688cd5676348344d7d0ec35e",
    "0xf4b245176de0108d8bd721c71a943aa1e041f058",
    "0xb82f31849e12a5f0460edbc6c78b56b7a33da4cf",
    "0xde2ae368e448369f1e1c1ae6dc94ad5218571047",
    "0x8ab428aa39e919705897f9d31d91f01c441c4813",
    "0x9a215304d686fe6ab67c79c3c273856798f8696d",
    "0x76b173f37cb39f288c2b97a8bea9bf96b643c485",
    "0xaf79312eb821871208ac76a80c8e282f8796964e",
    "0xa8c73ee57c268872b9d2d7a90e5f2e31af8493fb",
    "0xba7a099c1ca2c3fb2096624b550ca28903fdb6b3",
    "0xea8d50748078ef5ca45ff74fe582c1e723b53897",
    "0xdbc64be223ec220fa1f7d8791123a547d1b4e3f7",
    "0x2be14fda17e332f10ec3b5644ea17c37c31ee9cc",
    "0x88bf5a2e82510847e5dcbf33f44a9f611f1c1df5",
    "0xf663532633d1ab40999a7ab9ac4be4a93b88cfcf",
    "0x578eef570bbaab9723feef4ff2f39f35e0c1c95f",
    "0xd51a2a768157e73f58c0ebe8f98c9619b4962e5f",
    "0xed93a4e89ad6c27318eab868aa1efd2eb97fa13f",
    "0xe7bbb14678617e950d03e37cec48df611ed7d77b",
    "0x9d2cca7d9362680908260593cc9b5eb0a4fc739b",
    "0x668b3888bc4eb81942a96886484392aaf5d0c6fd",
    "0x8163e25ca82206c38cc3060dbaa316a2e577896b",
    "0xce2101e27fd0308c05e79bf37dde20eb83b50e18",
    "0x9a8d5d8c89dfc8f0bf8e2074579736b310b8f494",
    "0xddec9a082c1f17ed9137915b5f3c72841be3e747",
    "0x60fe5cbd886a778f584ffcc63833b068104d1f77",
    "0x20183a71fd916395f3ebbd0c0044e8f442ba6647",
    "0xa10a1035b9edd6ff720a4def0d7cf57e6bdb1d59",
    "0x022e3ce4eda264b3e3fef62036c8182ceb88e6ce",
    "0x7e646d9f5ee2947c66e87aa414f8a5e7b26dd380",
    "0x0ab4dcd5e3c1b918f34a13b475fe20af1147e8cf",
    "0xfecd45f735b2adf44b73d08ad211b6080714c4f5",
    "0x1122507b2a7a3d4c54396c12fa096f1a33341fa5",
    "0x4abe24d32a819e76aa3f80d9808db7a74c37eca6",
    "0x157b1c8c3de55b87be545b3dbc9d17f06f0112f8",
    "0xbf33c72b9b2dce5972af8067aa524bca7182a01f",
    "0xe2f71265af85c03df5f8c3949b0f7fc7bd85bce3",
    "0x8532e9d4141012b411bef8bb88818b7998ff939d",
    "0x3688355e18b077c01503d9736009874c271c2077",
    "0xa9a2da23f065a1483e701766cb8be761e855cee5",
    "0x72fa15bdc3d5bad61b7593037b6bc8035acec46f",
    "0x5d433b73ed2898e00e129ee87621af184bc00259",
    "0x2768ef0331cfde4cab0ffbf989c8f9d622c64c10",
    "0x1997490ec601d29d2f8a6c4b96757f9316000246",
    "0x11fef48755372f3828d36026fc79c47200d458e9",
    "0x789eb83d827c1380132fa2fbcca0fd9d4b074ed7",
    "0xcd34746eac14e60f666e3cee9d7991d045bbf761",
    "0x2e884770f9e11ba6b649039e34f7504ada6ad8bb",
    "0x2ac1d4ed5f6c0f20ffa29571910753e4cc941bb5",
    "0xe06991104f86421bcefed1febe286b3386801228",
    "0xe3964b997f1c7e6dee6ef028d7d2e6bbd3532acc",
    "0x66725488ff0977058b313022674c797fd3dd7134",
    "0xb73d0e383a02f23410a7ec33ca2eb9d71c7eeec6",
    "0x22c4f7d2a6c80ded6ce1d8b4a0cb0270adef635e",
    "0xbfc247609a65515c53c0cfc91da1070de8251ecd",
    "0xe1d14d5e2194ef26781ab9db90084747371beb0b",
    "0xa2550e6a5c1359aa8f68f73541f003e6cbd69cf6",
    "0xcc7b0f007b0cb1c4f653676d7069526a1649b8e1",
    "0xcc94c3477bdf2ae0ac82bb7ed1cdf44a5732bdda",
    "0xe45a718d1990eecece9a81503b69a2bbb231225c",
    "0x020fa4c69a6ff291525831a09f5aa334110f2cac",
    "0xca7422116e44eb8b63ad04de9592f75812f4f6a0",
    "0xe36cdd6ac020d335a58142c1e10d9bac83f36d9c",
    "0xc874cd4cd85c5a2553aa9fd0263af34603a8d977",
    "0x92a8799dadc94c11b4bcb635131cb49801ec0d55",
    "0x122f186c3fd1f8d218b8bf33711945e4f3fbeddf",
    "0x9a10586aa206a401ba50a168a847686d1e500dc6",
    "0x79019b783865479273d6977037562cfe65060330",
    "0x4ec989b6d17aebddab238eb2269067724f1e2883",
    "0xb0d0641247334404e43f48742abfbc2a4153f7ed",
    "0x87373f497a67d182d92c180c6ce2f74dc5d2acb7",
    "0xdce470208945edbb2adbb10fa0cad4dbb7682fd1",
    "0xeb3878f82558d5ec39b87f0a92efe4bc63fb77a5",
    "0xced85b70804a107338200cd9442903067c22259b",
    "0xbd564f813c7cb069c3214a1874b46a1607a51dca",
    "0x87411cc93cf4fa404b6cfdd648eb179d05cbf419",
    "0x8f36dc5348bf133941f07d4ea682354ca273d775",
    "0xc462bf6cd158e3301dc1bcdb11f48107f0ea8c82",
    "0xf0fc4955cc1424845fd5271b6f95f6c7e5832a63",
    "0x9cd3566dfb222872764250fcc858d5ef37cda594",
    "0x46c02c0c16cdfb2b1da16f42dab23860096cd63f",
    "0x0fb213a1af101b1429e6ad3020ad92fb0d25eb1e",
    "0xd6bab52dec2561b6dba8f4ca717a96bd0177b695",
    "0x9ffeb2a75e8fad479d978b4c9f9cfb41b8327c14",
    "0x73a933ea8f818b2438627f220a5fc1b3d51c9dec",
    "0x074db36e5b4023597a66ee13bbdeaecb00f975a8",
    "0xbd3f91e7c6f70d9f62524b83faed70c5ef8312db",
    "0x251529cb98cb17beda8963d4c742a7e791240768",
    "0x4cdf932bf58b4737391e9f536cf4f7fb905b2913",
    "0xaeceb942f7147b18c418fa417b3d38faac43d547",
    "0x8b07ca4130ae11a617a5d159ea4894653dfc35a8",
    "0xb135d40581404474beca15ba408e2e67a178b4cd",
    "0xe92a32c5b0f9305c7ccc0d30efa00ca0607d9b4d",
    "0x91bb7b68b4c9dda8d818237b3734b7e9bbd630ed",
    "0x63379a990db3aac431ed666926b30a8e9b4fdb96",
    "0x4030ebfa55ab8763d2a9896c5dc94c0440685749",
    "0xba715566ebb933102651465b02e8dba50b29dd43",
    "0x3ff61483d7000baa5cb0f2857cc6010a104fdb1c",
    "0x68c882487920d8c114b9f80c4bbf882f60befc5b",
    "0x3f13134c284a86c9d90a1593736c210ece1832b2",
    "0x97eda3c9f1e4c7ef743b552ab687aa49fca804c0",
    "0xf47c95a6efcf29c5e8864b260e87264bec354e94",
    "0x2b6090df20f11a27fdd2e8ad804f1cad61b5f9ba",
    "0x24e219ebf46093dc5c5a748cb20b8c83e86bf09d",
    "0xbffeb8b433f1dec4a003a94599e7b475cb2b3696",
    "0xc10e3ee8b7edb82e4ba53880c538dcc027c14e59",
    "0x3e04d4f5295dc916554b36264663b2540a588f50",
    "0x2cffee42f4ddc3d48918d0b60433c15811840939",
    "0x0ba47777592a51ab31702e5de27689a5466e7023",
    "0x0bc71bb95cc09743e22b1db6c282cdc295ea1989",
    "0x6cf2dac513b1d13124bc6332f85a79befa413b82",
    "0x99bfa37e6700904a8c6602903429ec4d91dfec96",
    "0xe07888d2f0e57a4bd0d0e30b6c7fb0a0178c6e0d",
    "0xb5a13e113541c7303e5ff1711c26ebef768780ee",
    "0x9d536d9d15392336de236887c0a5f9e23840f58b",
    "0xa9389b94805a2c9f2040ab454e4b1b94782bcc99",
    "0x9f4cb53e9a2e9aae05dce7f315c0437463326208",
    "0xec5b22756d0191fbbb4afffdd5ae2a660538d196",
    "0x1727ccc1121864aceaae711d53407a0814d2f023",
    "0x10eda8ab8cccc9f79009b5ad43c4ac7b8f0b1600",
    "0x359473d0c608c26c79673796391dd76ac7bc045e",
    "0x1e8167c23d437f16633c9768731c64d7d50c82e3",
    "0xddd7147ff6cff7e26628db8a7b238ae6bfe167f5",
    "0xd6a6d2578b71cc7aa21d083d9c3c816b36e53f93",
    "0xf06ad68aec551ca9f2803f534b1e67bc78e3f4e8",
    "0x1f8321b20f8cb8f09f8e3ea4aeee9ab904e80517",
    "0xc3ed8feaf358f7a48587dcef89761645a17034ad",
    "0xe71a7474b7ba68247727fc2a9fc03a7fab943e82",
    "0x6d81fbdba7cc3afb7926f80c734965746b297668",
    "0xd52c5795778fee69f8606dc046c4ceb45f882022",
    "0x428fb922793f20be0f5c6ffb5f2992ea3223cba1",
    "0x5fa76b66b112322ea06b3ddcc96fbb800254b232",
    "0x056b410cd12ed145f8c24f341d3e03b77ab7a8f4",
    "0xf99ead3a5b94cd5deaa32c5b5120027b5f34fcd4",
    "0xb06dcff74b96fd73152bb9fb4c64bb220eb0c646",
    "0xf9a5f8346b702d0f333f88c06d54536eae909837",
    "0xc5cb6f04a74a1ebac5745cef8512afdbe45bc702",
    "0xce2aeb589168317306b2c76d5cbeeffd2eacc895",
    "0xb70a0fc3933c160e7637c5e05f82e80c32c1c03f",
    "0x3a2a2583451c51090ff10415a93248d48aea7afa",
    "0x9892679bff8fd61ba483214f5a828250631eb3e8",
    "0x39bf3f54debdbd9e5bf3b1289a97f97b73b19fb1",
    "0x23404b031ecbb0ebbbc64bf235ddaf8fbd0e4f0b",
    "0xabc32db1fe279335a18d886537aada08610dc3a0",
    "0xfbf41e9885447303f30809ac6e73e58a30e2ac66",
    "0x66f35a0fb87868a1f9bbb5ca7c6c641941aab3a1",
    "0x3b63bbf52aa94016b61ee8d6809253f915d61411",
    "0x631df4c7f58dce6d5cc701b44cf3556545fe1c8b",
    "0x358d3d12dadb5de957354b2cf628f26bfe405129",
    "0x84c2d507920ce6f553dee92eaa81f869e9c82267",
    "0x5cc8322193db7b5df8846c6564dfcd44438aaef9",
    "0xdd485999e24368ed690d2dbd241ffa53f8136cea",
    "0x415d82d5f2be5b0af277c4e2579b56da4c646af7",
    "0x0e5fb95c84f02d044477261951a253dc36501e8f",
    "0xa13131208502db4b4c028ceb2f364c85ad48e4d3",
    "0x3c95981a365206c7d08bcfdc20b26ef45a9bf4b3",
    "0xa2b1c8798cac94cab5a7b493a473979a724e1a1c",
    "0x9cef6e59c214179ef24e30ef50b3e6c15a37d4e4",
    "0xcef444a89a976b26b848c266ccdc3b7e37aaba4b",
    "0x072d55788e0722c71a426c74a6ca3e52ec0fcd61",
    "0x0f123e655f0ec60c7dd06435d521cbe7824adadf",
    "0x6b7df0e099ba3b13b9a6d673283259111d026bd0",
    "0x53bb3c4870bae082c7715c26e17355781a1c33f2",
    "0x9af591b1582b85eb8112d70dedfe57c294e6c228",
    "0x374ca2a780871e5f4227587a44ebbae857cfda8f",
    "0xeaede341a19867b949a95862e6e9a9e9bc778a5b",
    "0xf7e76873739f5a362adbb4d984baec400efdc632",
    "0x80712c2d8186d5b1115bcea964a2e2f78a305444",
    "0xac7a677815ecd9c0ad2b13686f7ab54ff7485762",
    "0xef75264f97363a9439fc83f4695d43abaa8f80c1",
    "0x3231C08B500bb26e0654cb0338F135CeD44d6B84", // liquidator
  ];

  const chain = chains[chainId];
  const config = loadConfig(chainId);
  const provider = new ethers.providers.JsonRpcProvider(chain.rpc);
  const multicall = new MulticallWrapper(config.multicall, provider);
  const vaultStorage = VaultStorage__factory.connect(config.storages.vault, provider);
  const displayTable: CheckTotalTable[] = [];
  blockNumber = blockNumber || (await provider.getBlockNumber());

  const traderCollaterals: Record<string, ethers.BigNumber> = {};
  for (const [symbol, collateral] of Object.entries(collaterals)) {
    console.log(`Sum trader balances for ${symbol}`);
    let multicallCallData: Array<IMultiContractCall> = [];
    // Check all trader's collateral
    for (const account of accounts) {
      for (let i = 0; i < 6; i++) {
        multicallCallData.push({
          contract: vaultStorage,
          function: "traderBalances",
          params: [getSubAccount(account, i), collateral.address],
        });
      }
    }
    // Chunk it to escape max code size exceeded
    const chunks = _.chunk(multicallCallData, 20);
    const promises = chunks.map((chunk) =>
      multicall.multiContractCall<Array<ethers.BigNumber>>(chunk, { blockNumber })
    );
    const results = await Promise.all(promises);
    const rawCollaterals = _.flatten(results);
    traderCollaterals[symbol] = rawCollaterals.reduce(
      (acc, rawCollateral) => acc.add(rawCollateral),
      ethers.BigNumber.from(0)
    );
    // Query HLP's liquidity, Protocol fees, and totalAmount
    multicallCallData = [];
    multicallCallData.push(
      ...[
        {
          contract: vaultStorage,
          function: "hlpLiquidity",
          params: [collateral.address],
        },
        {
          contract: vaultStorage,
          function: "protocolFees",
          params: [collateral.address],
        },
        {
          contract: vaultStorage,
          function: "totalAmount",
          params: [collateral.address],
        },
        { contract: vaultStorage, function: "devFees", params: [collateral.address] },
        { contract: vaultStorage, function: "fundingFeeReserve", params: [collateral.address] },
      ]
    );
    const [hlpLiquidity, protocolFees, totalAmount, devFees, fundingFeeReserve] = await multicall.multiContractCall<
      Array<ethers.BigNumber>
    >(multicallCallData, { blockNumber });
    const sum = traderCollaterals[symbol].add(hlpLiquidity).add(protocolFees).add(devFees).add(fundingFeeReserve);
    displayTable.push({
      collateralSymbol: symbol,
      traderCollateral: ethers.utils.formatUnits(traderCollaterals[symbol], collateral.decimals),
      hlpLiquidity: ethers.utils.formatUnits(hlpLiquidity, collateral.decimals),
      protocolFees: ethers.utils.formatUnits(protocolFees, collateral.decimals),
      devFees: ethers.utils.formatUnits(devFees, collateral.decimals),
      fundingFeeReserve: ethers.utils.formatUnits(fundingFeeReserve, collateral.decimals),
      sum: ethers.utils.formatUnits(sum, collateral.decimals),
      totalAmount: ethers.utils.formatUnits(totalAmount, collateral.decimals),
      diff: ethers.utils.formatUnits(totalAmount.sub(sum), collateral.decimals),
    });
  }
  const block = blockNumber;
  console.log(`Block: ${block}`);
  console.table(displayTable);
}

const program = new Command();

program.requiredOption("--chain-id <number>", "chain id", parseInt);
program.option("--block-number <number>", "block number", parseInt);

const options = program.parse(process.argv).opts();

main(options.chainId, options.blockNumber)
  .then(() => {
    process.exit(0);
  })
  .catch((e) => {
    console.error(e);
    process.exit(1);
  });
